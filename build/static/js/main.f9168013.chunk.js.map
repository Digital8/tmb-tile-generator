{"version":3,"sources":["chance.ts","Tile.tsx","App.tsx","index.tsx"],"names":["chance","Chance","RESOLUTION","random","Math","makeDataURL","props","a","text","background","colors","font","rest","fontFamily","fontFace","FontFace","load","document","fonts","add","fontSize","fit","metrics","measure","tile","Tile","canvas","toCanvas","toDataURL","texts","gap","layout","Object","assign","this","distribution","Array","from","length","map","_","i","x","y","size","color","generator","halton","haltonND","bind","kronecker","kroneckerND","plastic","plasticND","take","getMetrics","scale","left","actualBoundingBoxLeft","right","actualBoundingBoxRight","ascent","actualBoundingBoxAscent","descent","actualBoundingBoxDescent","tick","boxes","forEach","op","instances","instance","xMin","yMin","box","push","boxIntersect","j","index","t","createElement","width","height","ctx","getContext","textAlign","textBaseline","blit","fillStyle","fillText","fillRect","renderToStaticMarkup","style","xmlns","flatMap","textAnchor","fill","fn","measureText","App","useState","setColors","setLayout","pickone","setBackground","setFont","first","setText","src","setSrc","useEffect","value","onChange","e","target","JSON","stringify","parse","window","templateProps","location","search","parsed","qs","slice","svg","url","div","debug","innerText","innerHTML","toSVG","body","appendChild","pdf","img","format","customSize","unit","data","fetchedAt","Date","getTime","toString","ReactDOM","render","StrictMode","getElementById"],"mappings":"qQACaA,EAAS,I,MAAIC,Q,kNCIpBC,EAAa,IACbC,EAASC,KAAKD,OAGb,SAAeE,EAAtB,kC,4CAAO,WAA2BC,GAA3B,mCAAAC,EAAA,6DACGC,EAA4CF,EAA5CE,KAAMC,EAAsCH,EAAtCG,WAAYC,EAA0BJ,EAA1BI,OAAQC,EAAkBL,EAAlBK,KAASC,EADtC,YAC+CN,EAD/C,GAKCO,EAAa,UACbC,EAAW,IAAIC,SAASF,EAAb,eANZ,OAGHF,QAHG,IAGHA,IACA,kHAEe,OANZ,SAOCG,EAASE,OAPV,cAQLC,SAASC,MAAMC,IAAIL,GACbM,EAAWC,EAAI,CACnBR,aACAL,SAEIc,EAAUC,EAAQ,CAAEZ,KAAK,GAAD,OAAKS,EAAL,cAAmBP,GAAcL,SACzDgB,EAAO,IAAIC,EAAJ,aACXd,KAAME,EACNL,OACAc,UACAF,WACAX,aACAC,UACGE,IAECc,EAASF,EAAKG,WAvBf,kBAwBED,EAAOE,aAxBT,6C,sBA2BA,IAAMH,EAAb,WASE,WAAYnB,GAYV,GADE,yBAnBJE,UAmBG,OAlBHqB,WAkBG,OAjBHT,cAiBG,OAhBHU,SAgBG,OAfHjB,gBAeG,OAdHJ,gBAcG,OAbHa,aAaG,OAZHS,YAYG,EACGzB,EAAMuB,MACRG,OAAOC,OAAOC,KAAM5B,OADtB,CAKA,IACEyB,EAQEzB,EARFyB,OACArB,EAOEJ,EAPFI,OAFF,EASIJ,EANF6B,oBAHF,MAGiB,UAHjB,IASI7B,EALFwB,WAJF,MAIQ,GAJR,EAKQjB,EAIJP,EAJFK,KACAW,EAGEhB,EAHFgB,QACAF,EAEEd,EAFFc,SACGR,EARL,YASIN,EATJ,GAWMuB,EAAS,WACb,GAAe,YAAXE,EACF,OAAOK,MAAMC,KAAK,CAAEC,OAAQ,IAAKC,KAAI,SAACC,EAAGC,GAAJ,MAAW,CAC9CC,EAAQ,GAAMD,EAAV,EACJE,EAAG,EACHC,KAAM,EACNC,MAAOnC,EAAQA,EAAO4B,OAASnC,IAAY,OAoD7C,IAlDM,IACA2C,EAAY,CAChBC,OAAQC,IAASC,KAAK,KAAM,CAAC,EAAG,IAChCC,UAAWC,IAAYF,KAAK,KAAM,CAAC,WAAI,EAAK,IAAK,WAAI,EAAK,MAC1DG,QAASC,IAAUJ,KAAK,KAAM,IAC9Bd,GAJgB,OAIF,IAAiB,KAAXhC,IAAmB,GACnC0B,EAAQO,MAAMC,KAAKiB,YAAU,GAAIR,IAAYP,KAAI,YAAa,IAAD,mBACjE,MAAO,CACLG,EAAO,EAFwD,KAEpD,EACXC,EAAO,EAHwD,KAGpD,EACXC,KAAM,IAAkB,IAAXzC,IACb0C,MAAOnC,EAAQA,EAAO4B,OAASnC,IAAY,OAGzCoD,EAAa,SAACC,GAClB,MAAO,CACLC,KAAMnC,EAAQoC,sBAAwBF,EACtCG,MAAOrC,EAAQsC,uBAAyBJ,EACxCK,OAAQvC,EAAQwC,wBAA0BN,EAC1CO,QAASzC,EAAQ0C,yBAA2BR,IAG1CS,EAAO,WACX,IAAMC,EAAQ,GACdrC,EAAMsC,SAAQ,SAAC3D,UACNA,EAAK4D,GACZ,IAAM9C,EAAUiC,EAAW/C,EAAKoC,MAChCyB,EAAU7D,GAAM,SAAC8D,GACf,IAAM5B,GAAM4B,EAAS5B,EAAI,GAAK,EAAKxC,EAC7ByC,GAAoB,EAAb2B,EAAS3B,GAAS,EAAKzC,EAC9BqE,EAAO7B,EAAIpB,EAAQmC,KACnBe,EAAO7B,EAAIrB,EAAQuC,OACnBY,EAAM,CACVF,EACAC,EACAD,EAAOjD,EAAQmC,KAAOnC,EAAQqC,MAC9Ba,EAAOlD,EAAQuC,OAASvC,EAAQyC,SAElCU,EAAIjE,KAAOA,EACX0D,EAAMQ,KAAKD,SAGfE,IAAaT,GAAO,SAACzB,EAAGmC,GACtB,CAACnC,EAAGmC,GAAGT,SAAQ,SAACU,GAAD,OAAYX,EAAMW,GAAOrE,KAAK4D,GAAK,eAGpDvC,EAAMsC,SAAQ,SAACW,GACbA,EAAElC,MAAiB,WAATkC,EAAEV,GAAkB,KAAY,UAGrCS,EAAQ,EAAGA,EA5HT,IA4H6BA,IACtCZ,IAEF,OAAOpC,EA7DI,GAiEfG,OAAOC,OAAOC,KAAdF,OAAA,IAAAA,QAAA,IAAAA,CAAA,GACKpB,GADL,IAEEiB,QACAT,WACAP,aACAiB,MACAR,cA5GN,4CA+GE,WAAY,IAAD,OACHI,EAAST,SAAS8D,cAAc,UACtCrD,EAAOsD,MAAQ9E,EACfwB,EAAOuD,OAAS/E,EAEhB,IAAMgF,EAAMxD,EAAOyD,WAAW,MAC9BD,EAAIE,UAAY,SAChBF,EAAIG,aAAe,aAEnB,IAAMC,EAAO,SAAChF,GAMZ4E,EAAIvE,KAAJ,UAAc,EAAKS,SAAWd,EAAMsC,MAAQ,EAAI,EAAKd,KAArD,cACE,EAAKjB,YAEPqE,EAAIK,UAAYjF,EAAMuC,MACtBwB,EAAU/D,GAAO,SAACgE,GAChB,IAAM5B,GAAM4B,EAAS5B,EAAI,GAAK,EAAKxC,EAC7ByC,GAAoB,EAAb2B,EAAS3B,GAAS,EAAKzC,EACpCgF,EAAIM,SAAS,EAAKhF,KAAMkC,EAAGC,OAW/B,OANEuC,EAAIK,UAAY,EAAK9E,WACrByE,EAAIO,SAAS,EAAG,EAAGvF,EAAYA,GAC/B,EAAK2B,MAAMsC,QAAQmB,GAId5D,IAhJX,uBAkJE,WACE,OAAOQ,KAAKP,WAAWC,cAnJ3B,mBAqJE,WAAS,IAAD,OACN,OAAO8D,+BACL,qBACEC,MAAO,CAAEX,MAAO,IAAKC,OAAQ,IAAKxE,WAAYyB,KAAKzB,YACnDmF,MAAM,6BAFR,SAIG1D,KAAKL,MAAMgE,SAAQ,SAACrF,GACnB,IAAMqB,EAAQ,GACRT,EAAQ,UAAM,EAAKA,SAAWZ,EAAKoC,MAAQ,EAAI,EAAKd,KAA5C,MAmBd,OAlBAuC,EAAU7D,GAAM,SAAC8D,GACf,IAAM5B,GAAM4B,EAAS5B,EAAI,GAAK,EAAKxC,EAC7ByC,GAAoB,EAAb2B,EAAS3B,GAAS,EAAKzC,EACpC2B,EAAM6C,KACJ,sBACEhC,EAAGA,EACHC,EAAGA,EACHgD,MAAO,CACLvE,WACAP,WAAY,EAAKA,YAEnBiF,WAAW,SACXC,KAAMvF,EAAKqC,MARb,SAUG,EAAKrC,WAILqB,YAhLjB,KAuLO,SAASwC,EAAT,EAA2C2B,GAChD,IAD0D,IAAhCtD,EAA+B,EAA/BA,EAAGC,EAA4B,EAA5BA,EAAM/B,EAAsB,iBAChD6B,GAAK,EAAGA,GAAK,EAAGA,IACvB,IAAK,IAAImC,GAAK,EAAGA,GAAK,EAAGA,IACvBoB,EAAG,2BAAKpF,GAAN,IAAY8B,EAAO,EAAJD,EAAQC,EAAGC,EAAO,EAAJiC,EAAQjC,KAKtC,SAAStB,EAAT,GAMH,IALFR,EAKC,EALDA,WACAL,EAIC,EAJDA,KASA,OAA2BN,IAJTqB,EAAQ,CACxBZ,KAAK,GAAD,OAAKT,GAAL,cAAyBW,GAC7BL,SAFMwE,MAIA9E,GAGH,SAASqB,EAAT,GAAkE,IAA/CZ,EAA8C,EAA9CA,KAAMH,EAAwC,EAAxCA,KACxBkB,EAAST,SAAS8D,cAAc,UACtCrD,EAAOsD,MAAQ9E,EACfwB,EAAOuD,OAAS/E,EAChB,IAAMgF,EAAMxD,EAAOyD,WAAW,MAI9B,OAHAD,EAAIE,UAAY,SAChBF,EAAIG,aAAe,aACnBH,EAAIvE,KAAOA,EACJuE,EAAIe,YAAYzF,GCpPlB,SAAS0F,EAAI5F,GAAa,IAAD,EAC9B,EAA4B6F,mBAAS,CAAC,UAAW,UAAW,YAA5D,mBAAOzF,EAAP,KAAe0F,EAAf,KAEA,EAA4BD,mBAAS,IAArC,mBAAOpE,EAAP,KAAesE,EAAf,KAEA,EAAoCF,mBAClCnG,EAAOsG,QAAQ,CAAC,UAAW,aAD7B,mBAAO7F,EAAP,KAAmB8F,EAAnB,KAGA,EAAwBJ,mBACtB,mHADF,mBAAOxF,EAAP,KAAa6F,EAAb,KAGA,EAAwBL,mBAAQ,UAAC7F,EAAME,YAAP,QAAeR,EAAOyG,SAAtD,mBAAOjG,EAAP,KAAakG,EAAb,KAEA,EAAsBP,mBAAc,MAApC,mBAAOQ,EAAP,KAAYC,EAAZ,KAyBA,OAvBAC,qBAAU,WACR,sBAAC,sBAAAtG,EAAA,kEACCqG,EADD,SAESvG,EAAY,CAChBI,aACAC,SACAF,OACAG,OACAoB,WAPL,4EAAD,KAWC,IAYD,qCACE,gCACE,2CACA,uBAAO+E,MAAO/E,EAAQgF,SAAU,SAACC,GAAD,OAAOX,EAAUW,EAAEC,OAAOH,aAE5D,gCACE,yCACA,uBAAOA,MAAOnG,EAAMoG,SAAU,SAACC,GAAD,OAAOR,EAAQQ,EAAEC,OAAOH,aAExD,gCACE,yCACA,uBAAOA,MAAOtG,EAAMuG,SAAU,SAACC,GAAD,OAAON,EAAQM,EAAEC,OAAOH,aAExD,gCACE,+CACA,uBACEA,MAAOrG,EACPsG,SAAU,SAACC,GAAD,OAAOT,EAAcS,EAAEC,OAAOH,aAG5C,gCACE,2CACA,uBACEA,MAAOI,KAAKC,UAAUzG,GACtBqG,SAAU,SAACC,GAAD,OAAOZ,EAAUc,KAAKE,MAAMJ,EAAEC,OAAOH,cAGnD,8BAAMH,EAAM,qBAAKA,IAAKA,IAAU,U,UChEtC,EAA+BU,OAAvBC,qBAAR,MAAwB,GAAxB,EAIA,GAAID,OAAOE,SAASC,OAAOlF,OAAS,EAAG,CACrC,IAAMmF,EAASC,IAAGN,MAAMC,OAAOE,SAASC,OAAOG,MAAM,IACrD3F,OAAOC,OAAOqF,EAAeG,GAG/B,GAAIH,EAAcM,IAChB,sBAAC,kDAAArH,EAAA,6DACSC,EAAqC8G,EAArC9G,KAAMC,EAA+B6G,EAA/B7G,WAAYC,EAAmB4G,EAAnB5G,OAAQqB,EAAWuF,EAAXvF,OAC5B8F,EAFP,UAGGP,EAAc3G,YAHjB,QAIG,kHACIE,EAAa,UACbC,EAAW,IAAIC,SAASF,EAAb,eAAiCgH,EAAjC,OANlB,SAOO/G,EAASE,OAPhB,OAQCC,SAASC,MAAMC,IAAIL,GACbM,EAAWC,EAAI,CACnBR,aACAL,SAEIc,EAAUC,EAAQ,CAAEZ,KAAK,GAAD,OAAKS,EAAL,cAAmBP,GAAcL,SACzDgB,EAAO,IAAIC,EAAK,CACpBd,KAAME,EACNL,OACAc,UACAF,WACAX,aACAC,SACAqB,WAEI+F,EAAM7G,SAAS8D,cAAc,OAC/BuC,EAAcS,MAChBD,EAAIE,UAAYd,KAAKC,UAAUG,GAE/BQ,EAAIG,UAAYzG,EAAK0G,QAEvBjH,SAASkH,KAAKC,YAAYN,GA7B3B,2CAAD,QA+BK,GAAIR,EAAce,IAAK,CAC5B,IAAMC,EAAMrH,SAAS8D,cAAc,OACnCuD,EAAI3B,IAAJ,uJAA0Je,IAAGP,UAC3J,CACEoB,OAAQ,MACRC,WAAY,CACVxD,MAAO,MACPC,OAAQ,MACRwD,KAAM,MAERC,KAAK,2BACApB,GADD,IAEFe,KAAK,EACLT,KAAK,IAEPe,WAAW,IAAIC,MAAOC,UAAUC,cAGpC7H,SAASkH,KAAKC,YAAYE,QAE1BS,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC/C,EAAD,eAASoB,MAEXrG,SAASiI,eAAe,W","file":"static/js/main.f9168013.chunk.js","sourcesContent":["import { Chance } from \"chance\";\nexport const chance = new Chance();\n","import { haltonND, kroneckerND, plasticND } from \"@thi.ng/lowdisc\";\nimport { take } from \"@thi.ng/transducers\";\nimport boxIntersect from \"box-intersect\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\n\nconst RESOLUTION = 512;\nconst random = Math.random;\nconst ITERATIONS = 256;\n\nexport async function makeDataURL(props: any) {\n  const { text, background, colors, font, ...rest } = props;\n  const url =\n    font ??\n    \"https://thatsmyblankie.wpengine.com/wp-content/themes/picostrap-child/fonts/customiser/UnicornsareAwesome.woff2\";\n  const fontFamily = \"blankie\";\n  const fontFace = new FontFace(fontFamily, `url(\"${url}\")`);\n  await fontFace.load();\n  document.fonts.add(fontFace);\n  const fontSize = fit({\n    fontFamily,\n    text,\n  });\n  const metrics = measure({ font: `${fontSize}px ${fontFamily}`, text });\n  const tile = new Tile({\n    font: fontFamily,\n    text,\n    metrics,\n    fontSize,\n    background,\n    colors,\n    ...rest,\n  });\n  const canvas = tile.toCanvas();\n  return canvas.toDataURL();\n}\n\nexport class Tile {\n  text!: string;\n  texts!: any[];\n  fontSize!: number;\n  gap!: number;\n  fontFamily!: string;\n  background!: string;\n  metrics!: TextMetrics;\n  layout?: string;\n  constructor(props: {\n    layout?: string;\n    text: string;\n    background: string;\n    font: string;\n    colors: string[];\n    distribution?: \"halton\" | \"kronecker\" | \"plastic\";\n    gap?: number;\n    metrics: TextMetrics;\n    texts?: any[];\n    fontSize?: number;\n  }) {\n    if (props.texts) {\n      Object.assign(this, props);\n      return;\n    }\n\n    const {\n      layout,\n      colors,\n      distribution = \"plastic\",\n      gap = 0.1,\n      font: fontFamily,\n      metrics,\n      fontSize,\n      ...rest\n    } = props;\n\n    const texts = (() => {\n      if (layout === \"stacked\") {\n        return Array.from({ length: 4 }).map((_, i) => ({\n          x: -1 + 0.5 * i,\n          y: 0,\n          size: 1,\n          color: colors[(colors.length * random()) | 0],\n        }));\n      } else {\n        const generator = {\n          halton: haltonND.bind(null, [2, 3]),\n          kronecker: kroneckerND.bind(null, [1 / 2 ** 0.5, 1 / 5 ** 0.5]),\n          plastic: plasticND.bind(null, 2),\n        }[distribution](0 ?? (random() * 1024) | 0);\n        const texts = Array.from(take<any>(32, generator)).map(([x, y]) => {\n          return {\n            x: x * 2 - 1,\n            y: y * 2 - 1,\n            size: 0.75 + random() * 0.75,\n            color: colors[(colors.length * random()) | 0],\n          };\n        });\n        const getMetrics = (scale: number) => {\n          return {\n            left: metrics.actualBoundingBoxLeft * scale,\n            right: metrics.actualBoundingBoxRight * scale,\n            ascent: metrics.actualBoundingBoxAscent * scale,\n            descent: metrics.actualBoundingBoxDescent * scale,\n          };\n        };\n        const tick = () => {\n          const boxes = [] as any;\n          texts.forEach((text: any) => {\n            delete text.op;\n            const metrics = getMetrics(text.size);\n            instances(text, (instance: any) => {\n              const x = ((instance.x + 1) / 2) * RESOLUTION;\n              const y = ((-instance.y + 1) / 2) * RESOLUTION;\n              const xMin = x - metrics.left;\n              const yMin = y - metrics.ascent;\n              const box = [\n                xMin,\n                yMin,\n                xMin + metrics.left + metrics.right,\n                yMin + metrics.ascent + metrics.descent,\n              ] as any;\n              box.text = text;\n              boxes.push(box);\n            });\n          });\n          boxIntersect(boxes, (i, j) => {\n            [i, j].forEach((index) => (boxes[index].text.op = \"shrink\"));\n          });\n          const delta = 1e-3 * 5;\n          texts.forEach((t: any) => {\n            t.size *= t.op === \"shrink\" ? 1 - delta : 1 + delta;\n          });\n        };\n        for (let index = 0; index < ITERATIONS; index++) {\n          tick();\n        }\n        return texts;\n      }\n    })();\n\n    Object.assign(this, {\n      ...rest,\n      texts,\n      fontSize,\n      fontFamily,\n      gap,\n      metrics,\n    });\n  }\n  toCanvas() {\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = RESOLUTION;\n    canvas.height = RESOLUTION;\n\n    const ctx = canvas.getContext(\"2d\")!;\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"alphabetic\";\n\n    const blit = (props: {\n      size: number;\n      x: number;\n      y: number;\n      color: string;\n    }) => {\n      ctx.font = `${this.fontSize * props.size * (1 - this.gap)}px ${\n        this.fontFamily\n      }`;\n      ctx.fillStyle = props.color;\n      instances(props, (instance: any) => {\n        const x = ((instance.x + 1) / 2) * RESOLUTION;\n        const y = ((-instance.y + 1) / 2) * RESOLUTION;\n        ctx.fillText(this.text, x, y);\n      });\n    };\n\n    const draw = () => {\n      ctx.fillStyle = this.background;\n      ctx.fillRect(0, 0, RESOLUTION, RESOLUTION);\n      this.texts.forEach(blit);\n    };\n    draw();\n\n    return canvas;\n  }\n  toDataURL() {\n    return this.toCanvas().toDataURL();\n  }\n  toSVG() {\n    return renderToStaticMarkup(\n      <svg\n        style={{ width: 512, height: 512, background: this.background }}\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        {this.texts.flatMap((text) => {\n          const texts = [] as any;\n          const fontSize = `${this.fontSize * text.size * (1 - this.gap)}px`;\n          instances(text, (instance: any) => {\n            const x = ((instance.x + 1) / 2) * RESOLUTION;\n            const y = ((-instance.y + 1) / 2) * RESOLUTION;\n            texts.push(\n              <text\n                x={x}\n                y={y}\n                style={{\n                  fontSize,\n                  fontFamily: this.fontFamily,\n                }}\n                textAnchor=\"middle\"\n                fill={text.color}\n              >\n                {this.text}\n              </text>\n            );\n          });\n          return texts;\n        })}\n      </svg>\n    );\n  }\n}\n\nexport function instances({ x, y, ...rest }: any, fn: any) {\n  for (let i = -1; i <= 1; i++) {\n    for (let j = -1; j <= 1; j++) {\n      fn({ ...rest, x: i * 2 + x, y: j * 2 + y });\n    }\n  }\n}\n\nexport function fit({\n  fontFamily,\n  text,\n}: {\n  fontFamily: string;\n  text: string;\n}) {\n  const { width } = measure({\n    font: `${RESOLUTION / 8}px ${fontFamily}`,\n    text,\n  });\n  return (RESOLUTION / 8) * (RESOLUTION / 4 / width);\n}\n\nexport function measure({ font, text }: { font: string; text: string }) {\n  const canvas = document.createElement(\"canvas\");\n  canvas.width = RESOLUTION;\n  canvas.height = RESOLUTION;\n  const ctx = canvas.getContext(\"2d\")!;\n  ctx.textAlign = \"center\";\n  ctx.textBaseline = \"alphabetic\";\n  ctx.font = font;\n  return ctx.measureText(text);\n}\n\nexport async function makeSVG(props: any) {\n  const { text, background, colors, font } = props;\n  const url =\n    font ??\n    \"https://thatsmyblankie.wpengine.com/wp-content/themes/picostrap-child/fonts/customiser/UnicornsareAwesome.woff2\";\n  const fontFamily = \"blankie\";\n  const fontFace = new FontFace(fontFamily, `url(\"${url}\")`);\n  await fontFace.load();\n  document.fonts.add(fontFace);\n  const fontSize = fit({\n    fontFamily,\n    text,\n  });\n  const metrics = measure({ font: `${fontSize}px ${fontFamily}`, text });\n  const tile = new Tile({\n    font: fontFamily,\n    text,\n    metrics,\n    fontSize,\n    background,\n    colors,\n  });\n  return tile.toSVG();\n}\n","import qs from \"qs\";\nimport { useEffect, useState } from \"react\";\nimport { chance } from \"./chance\";\nimport { makeDataURL } from \"./Tile\";\n\nexport function App(props: any) {\n  const [colors, setColors] = useState([\"#DA97B2\", \"#7EBCBE\", \"#676396\"]);\n\n  const [layout, setLayout] = useState(\"\");\n\n  const [background, setBackground] = useState(\n    chance.pickone([\"#111111\", \"#EEEEEE\"])\n  );\n  const [font, setFont] = useState(\n    \"https://thatsmyblankie.wpengine.com/wp-content/themes/picostrap-child/fonts/customiser/UnicornsareAwesome.woff2\"\n  );\n  const [text, setText] = useState(props.text ?? chance.first());\n\n  const [src, setSrc] = useState<any>(null);\n\n  useEffect(() => {\n    (async () => {\n      setSrc(\n        await makeDataURL({\n          background,\n          colors,\n          text,\n          font,\n          layout,\n        })\n      );\n    })();\n  }, []);\n\n  // const src = `https://cdn.make.cm/make/s/MeJxBCL1tTQQ?${qs.stringify({\n  //   data: {\n  //     background,\n  //     colors,\n  //     font,\n  //     text,\n  //   },\n  // })}`;\n\n  return (\n    <>\n      <div>\n        <label>Layout</label>\n        <input value={layout} onChange={(e) => setLayout(e.target.value)} />\n      </div>\n      <div>\n        <label>Font</label>\n        <input value={font} onChange={(e) => setFont(e.target.value)} />\n      </div>\n      <div>\n        <label>Text</label>\n        <input value={text} onChange={(e) => setText(e.target.value)} />\n      </div>\n      <div>\n        <label>Background</label>\n        <input\n          value={background}\n          onChange={(e) => setBackground(e.target.value)}\n        />\n      </div>\n      <div>\n        <label>Colors</label>\n        <input\n          value={JSON.stringify(colors)}\n          onChange={(e) => setColors(JSON.parse(e.target.value))}\n        />\n      </div>\n      <div>{src ? <img src={src} /> : null}</div>\n      {/* <div>\n        <a\n          href={`https://cdn.make.cm/make/s/LAs9Ky5L4Y98?${qs.stringify({\n            data: {\n              background,\n              colors,\n              font,\n              text,\n            },\n          })}`}\n        >\n          PDF\n        </a>\n      </div> */}\n    </>\n  );\n}\n\n// useEffect(() => {\n//   (async () => {\n\n//   })();\n// }, []);\n// return (\n//   <>\n//     {pdf ? <img src=\"./pdf.svg\" alt=\"\" /> : null}\n//     {svg ? (\n//       <svg viewBox=\"0 0 512 512\" style={{ width: 512, height: 512 }}>\n//         <text x=\"50%\" y=\"50%\" style={{ fontSize: \"72px\" }}>\n//           Test\n//         </text>\n//         <rect\n//           x=\"0\"\n//           y=\"0\"\n//           width=\"512\"\n//           height=\"512\"\n//           fill=\"none\"\n//           stroke=\"hotpink\"\n//         ></rect>\n//       </svg>\n//     ) : null}\n//   </>\n// );\n\n// {/* {tile ? (\n//         <div style={{ display: \"flex\" }}>\n//           <div\n//             style={{ width: 512, height: 512 }}\n//             dangerouslySetInnerHTML={{\n//               __html: (() => tile.toSVG())(),\n//             }}\n//           ></div>\n//           <img src={(() => tile.toDataURL())()} alt=\"\" />\n//         </div>\n//       ) : null} */}\n\n//       {/* <div style={{ display: \"flex\" }}>\n//         {!LIMIT ? (\n//           <img\n//             src={`https://cdn.make.cm/make/t/ba4c9684-a7af-4ca3-b929-291d6c196be3/k/639f5a8a-3056-48ff-bc67-c7613b9ecdca.b6d6a70ce98c5defcbc0282c9660dbc9/sync?${qs.stringify(\n//               {\n//                 format: \"png\",\n//                 customSize: {\n//                   width: \"512\",\n//                   height: \"512\",\n//                   unit: \"px\",\n//                 },\n//                 data: {\n//                   canvas: true,\n//                 },\n//                 fetchedAt: new Date().getTime().toString(),\n//               }\n//             )}`}\n//           />\n//         ) : null}\n//       </div> */}\n\n// const [tile, setTile] = useState<Tile | null>(null);\n\n// useEffect(() => {\n//   const worker = new Worker();\n//   const api = Comlink.wrap<any>(worker);\n//   const font = \"Dancing Script\";\n//   const fontSize = fit({\n//     fontFamily: font,\n//     text,\n//   });\n\n//   const metrics = measure({ font: `${fontSize}px ${font}`, text });\n//   const props = {\n//     background: chance.pickone([\"#111111\", \"#EEEEEE\"]),\n//     colors: [\"#DA97B2\", \"#7EBCBE\", \"#676396\"],\n//     font,\n//     text,\n//     metrics: {\n//       actualBoundingBoxAscent: metrics.actualBoundingBoxAscent,\n//       actualBoundingBoxDescent: metrics.actualBoundingBoxDescent,\n//       actualBoundingBoxLeft: metrics.actualBoundingBoxLeft,\n//       actualBoundingBoxRight: metrics.actualBoundingBoxRight,\n//       fontBoundingBoxAscent: metrics.fontBoundingBoxAscent,\n//       fontBoundingBoxDescent: metrics.fontBoundingBoxDescent,\n//       width: metrics.width,\n//     },\n//     fontSize,\n//   };\n//   (async () => {\n//     const tile = new Tile(await api.tile(props));\n//     setTile(tile);\n//   })();\n// }, [text]);\n","import qs from \"qs\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { App } from \"./App\";\nimport \"./index.css\";\nimport { fit, measure, Tile } from \"./Tile\";\n\nconst { templateProps = {} } = window as unknown as {\n  templateProps: Record<string, any>;\n};\n\nif (window.location.search.length > 1) {\n  const parsed = qs.parse(window.location.search.slice(1));\n  Object.assign(templateProps, parsed);\n}\n\nif (templateProps.svg) {\n  (async () => {\n    const { text, background, colors, layout } = templateProps;\n    const url =\n      templateProps.font ??\n      \"https://thatsmyblankie.wpengine.com/wp-content/themes/picostrap-child/fonts/customiser/UnicornsareAwesome.woff2\";\n    const fontFamily = \"blankie\";\n    const fontFace = new FontFace(fontFamily, `url(\"${url}\")`);\n    await fontFace.load();\n    document.fonts.add(fontFace);\n    const fontSize = fit({\n      fontFamily,\n      text,\n    });\n    const metrics = measure({ font: `${fontSize}px ${fontFamily}`, text });\n    const tile = new Tile({\n      font: fontFamily,\n      text,\n      metrics,\n      fontSize,\n      background,\n      colors,\n      layout,\n    });\n    const div = document.createElement(\"div\");\n    if (templateProps.debug) {\n      div.innerText = JSON.stringify(templateProps);\n    } else {\n      div.innerHTML = tile.toSVG();\n    }\n    document.body.appendChild(div);\n  })();\n} else if (templateProps.pdf) {\n  const img = document.createElement(\"img\");\n  img.src = `https://cdn.make.cm/make/t/ba4c9684-a7af-4ca3-b929-291d6c196be3/k/639f5a8a-3056-48ff-bc67-c7613b9ecdca.b6d6a70ce98c5defcbc0282c9660dbc9/sync?${qs.stringify(\n    {\n      format: \"svg\",\n      customSize: {\n        width: \"512\",\n        height: \"512\",\n        unit: \"px\",\n      },\n      data: {\n        ...templateProps,\n        pdf: false,\n        svg: true,\n      },\n      fetchedAt: new Date().getTime().toString(),\n    }\n  )}`;\n  document.body.appendChild(img);\n} else {\n  ReactDOM.render(\n    <React.StrictMode>\n      <App {...templateProps} />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n  );\n}\n\n// console.log(\n//   qs.stringify(\n//     {\n//       background: chance.pickone([\"#111111\", \"#EEEEEE\"]),\n//       colors: [\"#DA97B2\", \"#7EBCBE\", \"#676396\"],\n//     },\n//     { encodeValuesOnly: true }\n//   )\n// );\n"],"sourceRoot":""}